{
  "version": 3,
  "sources": ["Tools.user.ts"],
  "sourcesContent": ["// \u907F\u514D\u91CD\u8907\u5BA3\u544A _unsafeWindow\nconst _unsafeWindow = unsafeWindow ?? globalThis ?? window;\n\nconst IS_DEBUG_LOG: boolean = GM_getValue(\"IS_DEBUG_LOG\", false);\n\n/**\n * \u5F9E DOM \u4E2D\u79FB\u9664\u6307\u5B9A\u9078\u64C7\u5668\u7684\u6240\u6709\u5143\u7D20\u3002\n * @param args - CSS \u9078\u64C7\u5668\u5B57\u4E32\u9663\u5217\n * @returns [true, args] \u6216 [false, args, error]\n */\nexport function removeElement(...args: Array<string>) {\n  try {\n    if (args) {\n      args.forEach((args) => {\n        if (IS_DEBUG_LOG) {\n          console.log(\"args: \", args);\n          console.log(\n            \"document.querySelectorAll(args): \",\n            document.querySelectorAll(args)\n          );\n        }\n        if (document.querySelectorAll(args).length !== 0) {\n          document.querySelectorAll(args).forEach((ele) => {\n            ele.remove();\n          });\n        } else {\n          console.debug(args, \"is not a Html Element.\");\n        }\n      });\n    }\n  } catch (e) {\n    console.error(e);\n    return [false, args, e];\n  }\n  return [true, args];\n}\n\ntype setMenuFn = (ev?: MouseEvent | KeyboardEvent) => void;\n/**\n * \u8A3B\u518A\u4E00\u500B\u7528\u6236\u83DC\u55AE\u547D\u4EE4\uFF0C\u652F\u63F4\u5E03\u6797\u503C\u81EA\u52D5\u5207\u63DB\u8207\u81EA\u5B9A\u7FA9\u986F\u793A\u3002\n *\n * @param name - \u8A2D\u5B9A\u540D\u7A31\uFF08\u540C\u6642\u4F5C\u70BA GM \u5B58\u5132 key\uFF09\n * @param fn - (\u53EF\u9078) \u9EDE\u64CA\u6642\u57F7\u884C\u7684\u51FD\u6578\uFF0C\u82E5\u70BA\u5E03\u6797\u503C\u9810\u8A2D\u70BA\u5207\u63DB\u4E26\u91CD\u8F09\n * @param def - (\u53EF\u9078) \u9810\u8A2D\u503C\n * @param showMapping - (\u53EF\u9078) \u986F\u793A\u6620\u5C04\u8868\n * @returns \u83DC\u55AE\u547D\u4EE4ID\n *\n * @remarks\n * - \u5982\u679C\u503C\u70BA `name` \u662F\u672A\u5B9A\u7FA9\u7684\uFF0C\u4E14\u63D0\u4F9B\u4E86 `def`\uFF0C\u5247\u5C07 `def` \u8A2D\u7F6E\u70BA\u521D\u59CB\u503C\u3002\n * - \u5C0D\u65BC\u5E03\u6797\u503C\uFF0C\u83DC\u55AE\u6703\u986F\u793A\u5207\u63DB\u9078\u9805\uFF0C\u4E26\u5728\u8B8A\u66F4\u6642\u91CD\u65B0\u52A0\u8F09\u9801\u9762\u3002\n * - \u5C0D\u65BC\u4E0D\u652F\u6301\u7684\u985E\u578B\uFF0C\u7576\u9078\u64C7\u83DC\u55AE\u9805\u6642\u6703\u8A18\u9304\u932F\u8AA4\u3002\n */\nexport function setMenu(\n  name: string,\n  fn?: setMenuFn,\n  def?: any,\n  showMapping?: { [x: string]: string } | undefined\n): number {\n  // \u986F\u793A\u503C\u7684\u6620\u5C04\n  const trueShowMapping: { [x: string]: string } = {\n    true: \"\u958B\",\n    false: \"\u95DC\",\n    ...showMapping,\n  };\n  let support = false;\n  let showName: string = trueShowMapping[name] ?? name.replaceAll(\"_\", \" \");\n  let getValue: any = GM_getValue(name);\n  let showValue: string = \"No support\";\n  if (getValue === undefined && def !== undefined) {\n    // \u5982\u679C\u6C92\u6709\u503C\uFF0C\u5247\u4F7F\u7528\u9ED8\u8A8D\u503C\n    GM_setValue(name, def);\n    getValue = def;\n    console.debug(`setMenu: ${name} set default value: ${def}`);\n  }\n  if (typeof getValue === \"boolean\") {\n    support = true;\n    showValue = getValue.toString();\n  }\n  showValue = trueShowMapping[getValue] ?? showValue;\n\n  const trueFn =\n    fn ??\n    (support\n      ? function (ev: MouseEvent | KeyboardEvent) {\n          if (typeof getValue === \"boolean\") {\n            GM_setValue(name, !getValue);\n            globalThis.location.reload();\n          }\n        }\n      : () => {\n          let t = \"the type is not supported: \" + typeof getValue;\n\n          console.error(t);\n        });\n\n  return GM_registerMenuCommand(`${showName}: ${showValue}`, trueFn);\n}\n\nconst blackList: Array<string | RegExp> = [\n  \"eval\", // \u9632\u6B62\u57F7\u884C\u60E1\u610F\u4EE3\u78BC\n  \"function\", // \u9632\u6B62\u69CB\u9020\u65B0\u7684\u51FD\u6578\u5C0D\u8C61\n  \"let\",\n  \"var\", // \u9632\u6B62\u8B8A\u91CF\u8072\u660E\n  \"document\", // \u9632\u6B62 DOM \u64CD\u4F5C\n  \"alert\", // \u9632\u6B62\u5F48\u7A97\n  \"navigator\", // \u9632\u6B62\u7372\u53D6\u700F\u89BD\u5668\u76F8\u95DC\u4FE1\u606F\n  \"localStorage\",\n  \"sessionStorage\", // \u9632\u6B62\u8A2A\u554F\u700F\u89BD\u5668\u7684\u5B58\u5132\n  \"console\", // \u9632\u6B62\u4F7F\u7528 console.log \u6216\u5176\u4ED6\u63A7\u5236\u67B1\u65B9\u6CD5\n  \"XMLHttpRequest\",\n  \"fetch\", // \u9632\u6B62\u767C\u8D77\u7DB2\u7D61\u8ACB\u6C42\n  \"import\",\n  \"export\", // \u9632\u6B62\u6A21\u584A\u5C0E\u5165\u548C\u5C0E\u51FA\n  \"async\",\n  \"await\", // \u9632\u6B62\u5B9A\u7FA9\u7570\u6B65\u51FD\u6578\n  \"with\", // \u9632\u6B62\u4F7F\u7528 with \u8A9E\u53E5\n  \"Promise\", // \u9632\u6B62\u4F7F\u7528 Promise\uFF0C\u53EF\u80FD\u5C0E\u81F4\u8907\u96DC\u7684\u7570\u6B65\u64CD\u4F5C\n  /window\\.[\\da-zA-Z_]+ *=/, // \u6AA2\u67E5\u5C0D window \u5C0D\u8C61\u7684\u5C6C\u6027\u8CE6\u503C\n];\n/**\n * \u5B89\u5168\u57F7\u884C\u50B3\u5165\u7684\u5B57\u4E32\u4EE3\u78BC\uFF0C\u652F\u63F4\u9ED1\u540D\u55AE\u904E\u6FFE\u3002\n * @param stringCode - \u8981\u57F7\u884C\u7684\u4EE3\u78BC\n * @param safety - \u662F\u5426\u555F\u7528\u5B89\u5168\u904E\u6FFE\n * @returns \u57F7\u884C\u7D50\u679C\n * @throws \u82E5\u5305\u542B\u9ED1\u540D\u55AE\u95DC\u9375\u5B57\u5247\u4E1F\u51FA\u932F\u8AA4\n */\nexport function newEval(stringCode: string, safety: boolean = true) {\n  // \u6AA2\u67E5\u662F\u5426\u5305\u542B\u4E0D\u5141\u8A31\u7684\u95DC\u9375\u5B57\u6216\u4EE3\u78BC\n  if (safety) {\n    // \u904D\u6B77\u4E0D\u5141\u8A31\u7684\u5B57\u5143\u6216\u4EE3\u78BC\u5217\u8868\n    for (const value of blackList) {\n      if (typeof value === \"string\") {\n        if (stringCode.includes(value)) {\n          throw new Error(\n            `\u4E0D\u5141\u8A31\u7684\u95DC\u9375\u5B57\u6216\u4EE3\u78BC: ${JSON.stringify(\n              value\n            )},\u5728\u4EE3\u78BC: ${stringCode}`\n          );\n        }\n      } else if (value instanceof RegExp) {\n        if (value.test(stringCode)) {\n          throw new Error(\n            `\u4E0D\u5141\u8A31\u7684\u95DC\u9375\u5B57\u6216\u4EE3\u78BC: ${value},\u5728\u4EE3\u78BC: ${stringCode}`\n          );\n        }\n      }\n    }\n  }\n  // \u8FD4\u56DE\u57F7\u884C\u50B3\u5165\u5B57\u7B26\u4E32\u4EE3\u78BC\u7684\u7D50\u679C\n  return new Function(`${safety ? \"return\" : \"\"} ${stringCode}`)();\n}\n\n// #region i18n\n\n/**\n * \u591A\u8A9E\u7CFB(i18n)\u5DE5\u5177\u985E\uFF0C\u652F\u63F4\u591A\u8A9E\u8A00\u5B57\u5178\u8207\u52D5\u614B\u53C3\u6578\u66FF\u63DB\u3002\n */\nexport class I18n {\n  /** \u8A9E\u8A00\u5B57\u5178\u8CC7\u6599 */\n  public readonly langJson: {\n    [lang: string]: {\n      [key: string]: string;\n    };\n  };\n  /** \u8A9E\u8A00\u512A\u5148\u9806\u5E8F\u5217\u8868 */\n  public langList: Array<string> = [];\n\n  /**\n   * \u5EFA\u69CB\u5B50\n   * @param langJson - \u8A9E\u8A00\u5B57\u5178\n   * @param lang - \u8A9E\u8A00\u4EE3\u78BC\u6216\u8A9E\u8A00\u4EE3\u78BC\u9663\u5217\n   */\n  constructor(langJson: typeof this.langJson, lang: string | Array<string>) {\n    // \u69CB\u9020\u51FD\u6578\uFF0C\u63A5\u53D7\u8A9E\u8A00\u548C\u8A9E\u8A00\u6620\u5C04\n    this.langJson = langJson;\n    if (Array.isArray(lang)) {\n      // \u5982\u679C\u50B3\u5165\u7684\u662F\u6578\u7D44\n      this.langList.push(...lang);\n    } else if (typeof lang === \"string\") {\n      // \u5982\u679C\u50B3\u5165\u7684\u662F\u55AE\u500B\u8A9E\u8A00\n      this.langList.push(lang);\n    } else {\n      throw new TypeError(\"i18n:constructor:parameter:lang: not allow type\");\n    }\n  }\n\n  /**\n   * \u53D6\u5F97\u672C\u5730\u5316\u5B57\u4E32\uFF0C\u652F\u63F4\u53C3\u6578\u66FF\u63DB\u3002\n   * @param key - \u5B57\u5178\u9375\u503C\n   * @param args - \u53C3\u6578\n   * @returns \u5C0D\u61C9\u8A9E\u8A00\u7684\u5B57\u4E32\uFF0C\u82E5\u7121\u5247\u56DE\u50B3key\n   */\n  public get(\n    key: keyof (typeof this.langJson)[keyof typeof this.langJson],\n    ...args: Array<any>\n  ): string {\n    for (const lang of this?.langList) {\n      // \u904D\u6B77\u8A9E\u8A00\u5217\u8868\n      if (this.langJson[lang]?.[key]) {\n        // \u6AA2\u67E5\u8A9E\u8A00\u6620\u5C04\u4E2D\u662F\u5426\u5B58\u5728\u8A72\u9375\n        let text = this.langJson[lang][key]; // \u7372\u53D6\u5C0D\u61C9\u7684\u8A9E\u8A00\u6587\u672C\n        if (args && args.length > 0) {\n          // \u5982\u679C\u50B3\u5165\u4E86\u53C3\u6578\n          text = text.replace(/{(\\d+)}/g, (match, number) => {\n            if (number >= 0 && number < args.length) {\n              // \u66FF\u63DB\u6587\u672C\u4E2D\u7684 {n} \u53C3\u6578\n              return typeof args[number] === \"undefined\" ? match : args[number];\n            }\n            return match;\n          });\n        }\n        return text;\n      }\n    }\n    console.warn(`Translation missing for key: \"${key}\"`); // \u8B66\u544A\u7F3A\u5C11\u7684\u7FFB\u8B6F\n    return String(key); // \u5982\u679C\u6C92\u6709\u627E\u5230\u5C0D\u61C9\u7684\u7FFB\u8B6F\uFF0C\u8FD4\u56DEkey\u672C\u8EAB\n  }\n  /**\n   * \u5225\u540D\uFF0C\u7B49\u540C get\n   */\n  public t = this.get;\n}\n// #endregion i18n\n"],
  "mappings": "mBACA,IAAMA,EAAgB,cAAgB,YAAc,OAE9CC,EAAwB,YAAY,eAAgB,EAAK,EAOxD,SAASC,KAAiBC,EAAqB,CACpD,GAAI,CACEA,GACFA,EAAK,QAASA,GAAS,CACjBF,IACF,QAAQ,IAAI,SAAUE,CAAI,EAC1B,QAAQ,IACN,oCACA,SAAS,iBAAiBA,CAAI,CAChC,GAEE,SAAS,iBAAiBA,CAAI,EAAE,SAAW,EAC7C,SAAS,iBAAiBA,CAAI,EAAE,QAASC,GAAQ,CAC/CA,EAAI,OAAO,CACb,CAAC,EAED,QAAQ,MAAMD,EAAM,wBAAwB,CAEhD,CAAC,CAEL,OAASE,EAAG,CACV,eAAQ,MAAMA,CAAC,EACR,CAAC,GAAOF,EAAME,CAAC,CACxB,CACA,MAAO,CAAC,GAAMF,CAAI,CACpB,CAiBO,SAASG,EACdC,EACAC,EACAC,EACAC,EACQ,CAER,IAAMC,EAA2C,CAC/C,KAAM,SACN,MAAO,SACP,GAAGD,CACL,EACIE,EAAU,GACVC,EAAmBF,EAAgBJ,CAAI,GAAKA,EAAK,WAAW,IAAK,GAAG,EACpEO,EAAgB,YAAYP,CAAI,EAChCQ,EAAoB,aACpBD,IAAa,QAAaL,IAAQ,SAEpC,YAAYF,EAAME,CAAG,EACrBK,EAAWL,EACX,QAAQ,MAAM,YAAYF,CAAI,uBAAuBE,CAAG,EAAE,GAExD,OAAOK,GAAa,YACtBF,EAAU,GACVG,EAAYD,EAAS,SAAS,GAEhCC,EAAYJ,EAAgBG,CAAQ,GAAKC,EAEzC,IAAMC,EACJR,IACCI,EACG,SAAUK,EAAgC,CACpC,OAAOH,GAAa,YACtB,YAAYP,EAAM,CAACO,CAAQ,EAC3B,WAAW,SAAS,OAAO,EAE/B,EACA,IAAM,CACJ,IAAII,EAAI,8BAAgC,OAAOJ,EAE/C,QAAQ,MAAMI,CAAC,CACjB,GAEN,OAAO,uBAAuB,GAAGL,CAAQ,KAAKE,CAAS,GAAIC,CAAM,CACnE,CAEA,IAAMG,EAAoC,CACxC,OACA,WACA,MACA,MACA,WACA,QACA,YACA,eACA,iBACA,UACA,iBACA,QACA,SACA,SACA,QACA,QACA,OACA,UACA,yBACF,EAQO,SAASC,EAAQC,EAAoBC,EAAkB,GAAM,CAElE,GAAIA,GAEF,QAAWC,KAASJ,EAClB,GAAI,OAAOI,GAAU,UACnB,GAAIF,EAAW,SAASE,CAAK,EAC3B,MAAM,IAAI,MACR,iEAAe,KAAK,UAClBA,CACF,CAAC,wBAASF,CAAU,EACtB,UAEOE,aAAiB,QACtBA,EAAM,KAAKF,CAAU,EACvB,MAAM,IAAI,MACR,iEAAeE,CAAK,wBAASF,CAAU,EACzC,EAMR,OAAO,IAAI,SAAS,GAAGC,EAAS,SAAW,EAAE,IAAID,CAAU,EAAE,EAAE,CACjE,CAOO,IAAMG,EAAN,KAAW,CAEA,SAMT,SAA0B,CAAC,EAOlC,YAAYC,EAAgCC,EAA8B,CAGxE,GADA,KAAK,SAAWD,EACZ,MAAM,QAAQC,CAAI,EAEpB,KAAK,SAAS,KAAK,GAAGA,CAAI,UACjB,OAAOA,GAAS,SAEzB,KAAK,SAAS,KAAKA,CAAI,MAEvB,OAAM,IAAI,UAAU,iDAAiD,CAEzE,CAQO,IACLC,KACGxB,EACK,CACR,QAAWuB,KAAQ,MAAM,SAEvB,GAAI,KAAK,SAASA,CAAI,IAAIC,CAAG,EAAG,CAE9B,IAAIC,EAAO,KAAK,SAASF,CAAI,EAAEC,CAAG,EAClC,OAAIxB,GAAQA,EAAK,OAAS,IAExByB,EAAOA,EAAK,QAAQ,WAAY,CAACC,EAAOC,IAClCA,GAAU,GAAKA,EAAS3B,EAAK,OAExB,OAAOA,EAAK2B,CAAM,EAAM,IAAcD,EAAQ1B,EAAK2B,CAAM,EAE3DD,CACR,GAEID,CACT,CAEF,eAAQ,KAAK,iCAAiCD,CAAG,GAAG,EAC7C,OAAOA,CAAG,CACnB,CAIO,EAAI,KAAK,GAClB",
  "names": ["_unsafeWindow", "IS_DEBUG_LOG", "removeElement", "args", "ele", "e", "setMenu", "name", "fn", "def", "showMapping", "trueShowMapping", "support", "showName", "getValue", "showValue", "trueFn", "ev", "t", "blackList", "newEval", "stringCode", "safety", "value", "I18n", "langJson", "lang", "key", "text", "match", "number"]
}
