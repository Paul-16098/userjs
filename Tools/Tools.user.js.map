{
  "version": 3,
  "sources": ["Tools.user.ts"],
  "sourcesContent": ["// \u907F\u514D\u91CD\u8907\u5BA3\u544A _unsafeWindow\r\nconst _unsafeWindow = unsafeWindow ?? globalThis ?? window;\r\n\r\nconst IS_DEBUG_LOG: boolean = GM_getValue(\"IS_DEBUG_LOG\", false);\r\n\r\n/**\r\n * \u5F9E DOM \u4E2D\u79FB\u9664\u6307\u5B9A\u9078\u64C7\u5668\u7684\u6240\u6709\u5143\u7D20\u3002\r\n * @param args - CSS \u9078\u64C7\u5668\u5B57\u4E32\u9663\u5217\r\n * @returns [true, args] \u6216 [false, args, error]\r\n */\r\nexport function removeElement(...args: Array<string>) {\r\n  try {\r\n    if (args) {\r\n      args.forEach((args) => {\r\n        if (IS_DEBUG_LOG) {\r\n          console.log(\"args: \", args);\r\n          console.log(\r\n            \"document.querySelectorAll(args): \",\r\n            document.querySelectorAll(args)\r\n          );\r\n        }\r\n        if (document.querySelectorAll(args).length !== 0) {\r\n          document.querySelectorAll(args).forEach((ele) => {\r\n            ele.remove();\r\n          });\r\n        } else {\r\n          console.debug(args, \"is not a Html Element.\");\r\n        }\r\n      });\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    return [false, args, e];\r\n  }\r\n  return [true, args];\r\n}\r\n\r\ntype setMenuFn = (ev?: MouseEvent | KeyboardEvent) => void;\r\n/**\r\n * \u8A3B\u518A\u4E00\u500B\u7528\u6236\u83DC\u55AE\u547D\u4EE4\uFF0C\u652F\u63F4\u5E03\u6797\u503C\u81EA\u52D5\u5207\u63DB\u8207\u81EA\u5B9A\u7FA9\u986F\u793A\u3002\r\n *\r\n * @param name - \u8A2D\u5B9A\u540D\u7A31\uFF08\u540C\u6642\u4F5C\u70BA GM \u5B58\u5132 key\uFF09\r\n * @param fn - (\u53EF\u9078) \u9EDE\u64CA\u6642\u57F7\u884C\u7684\u51FD\u6578\uFF0C\u82E5\u70BA\u5E03\u6797\u503C\u9810\u8A2D\u70BA\u5207\u63DB\u4E26\u91CD\u8F09\r\n * @param def - (\u53EF\u9078) \u9810\u8A2D\u503C\r\n * @param showMapping - (\u53EF\u9078) \u986F\u793A\u6620\u5C04\u8868\r\n * @returns \u83DC\u55AE\u547D\u4EE4ID\r\n *\r\n * @remarks\r\n * - \u5982\u679C\u503C\u70BA `name` \u662F\u672A\u5B9A\u7FA9\u7684\uFF0C\u4E14\u63D0\u4F9B\u4E86 `def`\uFF0C\u5247\u5C07 `def` \u8A2D\u7F6E\u70BA\u521D\u59CB\u503C\u3002\r\n * - \u5C0D\u65BC\u5E03\u6797\u503C\uFF0C\u83DC\u55AE\u6703\u986F\u793A\u5207\u63DB\u9078\u9805\uFF0C\u4E26\u5728\u8B8A\u66F4\u6642\u91CD\u65B0\u52A0\u8F09\u9801\u9762\u3002\r\n * - \u5C0D\u65BC\u4E0D\u652F\u6301\u7684\u985E\u578B\uFF0C\u7576\u9078\u64C7\u83DC\u55AE\u9805\u6642\u6703\u8A18\u9304\u932F\u8AA4\u3002\r\n */\r\nexport function setMenu(\r\n  name: string,\r\n  fn?: setMenuFn,\r\n  def?: any,\r\n  showMapping?: { [x: string]: string } | undefined\r\n): number {\r\n  // \u986F\u793A\u503C\u7684\u6620\u5C04\r\n  const trueShowMapping: { [x: string]: string } = {\r\n    true: \"\u958B\",\r\n    false: \"\u95DC\",\r\n    ...showMapping,\r\n  };\r\n  let support = false;\r\n  let showName: string = trueShowMapping[name] ?? name.replaceAll(\"_\", \" \");\r\n  let getValue: any = GM_getValue(name);\r\n  let showValue: string = \"No support\";\r\n  if (getValue === undefined && def !== undefined) {\r\n    // \u5982\u679C\u6C92\u6709\u503C\uFF0C\u5247\u4F7F\u7528\u9ED8\u8A8D\u503C\r\n    GM_setValue(name, def);\r\n    getValue = def;\r\n    console.debug(`setMenu: ${name} set default value: ${def}`);\r\n  }\r\n  if (typeof getValue === \"boolean\") {\r\n    support = true;\r\n    showValue = getValue.toString();\r\n  }\r\n  showValue = trueShowMapping[getValue] ?? showValue;\r\n\r\n  const trueFn =\r\n    fn ??\r\n    (support\r\n      ? function (ev: MouseEvent | KeyboardEvent) {\r\n          if (typeof getValue === \"boolean\") {\r\n            GM_setValue(name, !getValue);\r\n            globalThis.location.reload();\r\n          }\r\n        }\r\n      : () => {\r\n          let t = \"the type is not supported: \" + typeof getValue;\r\n\r\n          console.error(t);\r\n        });\r\n\r\n  return GM_registerMenuCommand(`${showName}: ${showValue}`, trueFn);\r\n}\r\n\r\nconst blackList: Array<string | RegExp> = [\r\n  \"eval\", // \u9632\u6B62\u57F7\u884C\u60E1\u610F\u4EE3\u78BC\r\n  \"function\", // \u9632\u6B62\u69CB\u9020\u65B0\u7684\u51FD\u6578\u5C0D\u8C61\r\n  \"let\",\r\n  \"var\", // \u9632\u6B62\u8B8A\u91CF\u8072\u660E\r\n  \"document\", // \u9632\u6B62 DOM \u64CD\u4F5C\r\n  \"alert\", // \u9632\u6B62\u5F48\u7A97\r\n  \"navigator\", // \u9632\u6B62\u7372\u53D6\u700F\u89BD\u5668\u76F8\u95DC\u4FE1\u606F\r\n  \"localStorage\",\r\n  \"sessionStorage\", // \u9632\u6B62\u8A2A\u554F\u700F\u89BD\u5668\u7684\u5B58\u5132\r\n  \"console\", // \u9632\u6B62\u4F7F\u7528 console.log \u6216\u5176\u4ED6\u63A7\u5236\u67B1\u65B9\u6CD5\r\n  \"XMLHttpRequest\",\r\n  \"fetch\", // \u9632\u6B62\u767C\u8D77\u7DB2\u7D61\u8ACB\u6C42\r\n  \"import\",\r\n  \"export\", // \u9632\u6B62\u6A21\u584A\u5C0E\u5165\u548C\u5C0E\u51FA\r\n  \"async\",\r\n  \"await\", // \u9632\u6B62\u5B9A\u7FA9\u7570\u6B65\u51FD\u6578\r\n  \"with\", // \u9632\u6B62\u4F7F\u7528 with \u8A9E\u53E5\r\n  \"Promise\", // \u9632\u6B62\u4F7F\u7528 Promise\uFF0C\u53EF\u80FD\u5C0E\u81F4\u8907\u96DC\u7684\u7570\u6B65\u64CD\u4F5C\r\n  /window\\.[\\da-zA-Z_]+ *=/, // \u6AA2\u67E5\u5C0D window \u5C0D\u8C61\u7684\u5C6C\u6027\u8CE6\u503C\r\n];\r\n/**\r\n * \u5B89\u5168\u57F7\u884C\u50B3\u5165\u7684\u5B57\u4E32\u4EE3\u78BC\uFF0C\u652F\u63F4\u9ED1\u540D\u55AE\u904E\u6FFE\u3002\r\n * @param stringCode - \u8981\u57F7\u884C\u7684\u4EE3\u78BC\r\n * @param safety - \u662F\u5426\u555F\u7528\u5B89\u5168\u904E\u6FFE\r\n * @returns \u57F7\u884C\u7D50\u679C\r\n * @throws \u82E5\u5305\u542B\u9ED1\u540D\u55AE\u95DC\u9375\u5B57\u5247\u4E1F\u51FA\u932F\u8AA4\r\n */\r\nexport function newEval(stringCode: string, safety: boolean = true) {\r\n  // \u6AA2\u67E5\u662F\u5426\u5305\u542B\u4E0D\u5141\u8A31\u7684\u95DC\u9375\u5B57\u6216\u4EE3\u78BC\r\n  if (safety) {\r\n    // \u904D\u6B77\u4E0D\u5141\u8A31\u7684\u5B57\u5143\u6216\u4EE3\u78BC\u5217\u8868\r\n    for (const value of blackList) {\r\n      if (typeof value === \"string\") {\r\n        if (stringCode.includes(value)) {\r\n          throw new Error(\r\n            `\u4E0D\u5141\u8A31\u7684\u95DC\u9375\u5B57\u6216\u4EE3\u78BC: ${JSON.stringify(\r\n              value\r\n            )},\u5728\u4EE3\u78BC: ${stringCode}`\r\n          );\r\n        }\r\n      } else if (value instanceof RegExp) {\r\n        if (value.test(stringCode)) {\r\n          throw new Error(\r\n            `\u4E0D\u5141\u8A31\u7684\u95DC\u9375\u5B57\u6216\u4EE3\u78BC: ${value},\u5728\u4EE3\u78BC: ${stringCode}`\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // \u8FD4\u56DE\u57F7\u884C\u50B3\u5165\u5B57\u7B26\u4E32\u4EE3\u78BC\u7684\u7D50\u679C\r\n  return new Function(`${safety ? \"return\" : \"\"} ${stringCode}`)();\r\n}\r\n\r\n// #region i18n\r\n\r\n/**\r\n * \u591A\u8A9E\u7CFB(i18n)\u5DE5\u5177\u985E\uFF0C\u652F\u63F4\u591A\u8A9E\u8A00\u5B57\u5178\u8207\u52D5\u614B\u53C3\u6578\u66FF\u63DB\u3002\r\n */\r\nexport class I18n {\r\n  /** \u8A9E\u8A00\u5B57\u5178\u8CC7\u6599 */\r\n  public readonly langJson: {\r\n    [lang: string]: {\r\n      [key: string]: string;\r\n    };\r\n  };\r\n  /** \u8A9E\u8A00\u512A\u5148\u9806\u5E8F\u5217\u8868 */\r\n  public langList: Array<string> = [];\r\n\r\n  /**\r\n   * \u5EFA\u69CB\u5B50\r\n   * @param langJson - \u8A9E\u8A00\u5B57\u5178\r\n   * @param lang - \u8A9E\u8A00\u4EE3\u78BC\u6216\u8A9E\u8A00\u4EE3\u78BC\u9663\u5217\r\n   */\r\n  constructor(langJson: typeof this.langJson, lang: string | Array<string>) {\r\n    // \u69CB\u9020\u51FD\u6578\uFF0C\u63A5\u53D7\u8A9E\u8A00\u548C\u8A9E\u8A00\u6620\u5C04\r\n    this.langJson = langJson;\r\n    if (Array.isArray(lang)) {\r\n      // \u5982\u679C\u50B3\u5165\u7684\u662F\u6578\u7D44\r\n      this.langList.push(...lang);\r\n    } else if (typeof lang === \"string\") {\r\n      // \u5982\u679C\u50B3\u5165\u7684\u662F\u55AE\u500B\u8A9E\u8A00\r\n      this.langList.push(lang);\r\n    } else {\r\n      throw new TypeError(\"i18n:constructor:parameter:lang: not allow type\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u53D6\u5F97\u672C\u5730\u5316\u5B57\u4E32\uFF0C\u652F\u63F4\u53C3\u6578\u66FF\u63DB\u3002\r\n   * @param key - \u5B57\u5178\u9375\u503C\r\n   * @param args - \u53C3\u6578\r\n   * @returns \u5C0D\u61C9\u8A9E\u8A00\u7684\u5B57\u4E32\uFF0C\u82E5\u7121\u5247\u56DE\u50B3key\r\n   */\r\n  public get(\r\n    key: keyof (typeof this.langJson)[keyof typeof this.langJson],\r\n    ...args: Array<any>\r\n  ): string {\r\n    for (const lang of this?.langList) {\r\n      // \u904D\u6B77\u8A9E\u8A00\u5217\u8868\r\n      if (this.langJson[lang]?.[key]) {\r\n        // \u6AA2\u67E5\u8A9E\u8A00\u6620\u5C04\u4E2D\u662F\u5426\u5B58\u5728\u8A72\u9375\r\n        let text = this.langJson[lang][key]; // \u7372\u53D6\u5C0D\u61C9\u7684\u8A9E\u8A00\u6587\u672C\r\n        if (args && args.length > 0) {\r\n          // \u5982\u679C\u50B3\u5165\u4E86\u53C3\u6578\r\n          text = text.replace(/{(\\d+)}/g, (match, number) => {\r\n            if (number >= 0 && number < args.length) {\r\n              // \u66FF\u63DB\u6587\u672C\u4E2D\u7684 {n} \u53C3\u6578\r\n              return typeof args[number] === \"undefined\" ? match : args[number];\r\n            }\r\n            return match;\r\n          });\r\n        }\r\n        return text;\r\n      }\r\n    }\r\n    console.warn(`Translation missing for key: \"${key}\"`); // \u8B66\u544A\u7F3A\u5C11\u7684\u7FFB\u8B6F\r\n    return String(key); // \u5982\u679C\u6C92\u6709\u627E\u5230\u5C0D\u61C9\u7684\u7FFB\u8B6F\uFF0C\u8FD4\u56DEkey\u672C\u8EAB\r\n  }\r\n  /**\r\n   * \u5225\u540D\uFF0C\u7B49\u540C get\r\n   */\r\n  public t = this.get;\r\n}\r\n// #endregion i18n\r\n"],
  "mappings": "mBACA,IAAMA,EAAgB,cAAgB,YAAc,OAE9CC,EAAwB,YAAY,eAAgB,EAAK,EAOxD,SAASC,KAAiBC,EAAqB,CACpD,GAAI,CACEA,GACFA,EAAK,QAASA,GAAS,CACjBF,IACF,QAAQ,IAAI,SAAUE,CAAI,EAC1B,QAAQ,IACN,oCACA,SAAS,iBAAiBA,CAAI,CAChC,GAEE,SAAS,iBAAiBA,CAAI,EAAE,SAAW,EAC7C,SAAS,iBAAiBA,CAAI,EAAE,QAASC,GAAQ,CAC/CA,EAAI,OAAO,CACb,CAAC,EAED,QAAQ,MAAMD,EAAM,wBAAwB,CAEhD,CAAC,CAEL,OAASE,EAAG,CACV,eAAQ,MAAMA,CAAC,EACR,CAAC,GAAOF,EAAME,CAAC,CACxB,CACA,MAAO,CAAC,GAAMF,CAAI,CACpB,CAiBO,SAASG,EACdC,EACAC,EACAC,EACAC,EACQ,CAER,IAAMC,EAA2C,CAC/C,KAAM,SACN,MAAO,SACP,GAAGD,CACL,EACIE,EAAU,GACVC,EAAmBF,EAAgBJ,CAAI,GAAKA,EAAK,WAAW,IAAK,GAAG,EACpEO,EAAgB,YAAYP,CAAI,EAChCQ,EAAoB,aACpBD,IAAa,QAAaL,IAAQ,SAEpC,YAAYF,EAAME,CAAG,EACrBK,EAAWL,EACX,QAAQ,MAAM,YAAYF,CAAI,uBAAuBE,CAAG,EAAE,GAExD,OAAOK,GAAa,YACtBF,EAAU,GACVG,EAAYD,EAAS,SAAS,GAEhCC,EAAYJ,EAAgBG,CAAQ,GAAKC,EAEzC,IAAMC,EACJR,IACCI,EACG,SAAUK,EAAgC,CACpC,OAAOH,GAAa,YACtB,YAAYP,EAAM,CAACO,CAAQ,EAC3B,WAAW,SAAS,OAAO,EAE/B,EACA,IAAM,CACJ,IAAII,EAAI,8BAAgC,OAAOJ,EAE/C,QAAQ,MAAMI,CAAC,CACjB,GAEN,OAAO,uBAAuB,GAAGL,CAAQ,KAAKE,CAAS,GAAIC,CAAM,CACnE,CAEA,IAAMG,EAAoC,CACxC,OACA,WACA,MACA,MACA,WACA,QACA,YACA,eACA,iBACA,UACA,iBACA,QACA,SACA,SACA,QACA,QACA,OACA,UACA,yBACF,EAQO,SAASC,EAAQC,EAAoBC,EAAkB,GAAM,CAElE,GAAIA,GAEF,QAAWC,KAASJ,EAClB,GAAI,OAAOI,GAAU,UACnB,GAAIF,EAAW,SAASE,CAAK,EAC3B,MAAM,IAAI,MACR,iEAAe,KAAK,UAClBA,CACF,CAAC,wBAASF,CAAU,EACtB,UAEOE,aAAiB,QACtBA,EAAM,KAAKF,CAAU,EACvB,MAAM,IAAI,MACR,iEAAeE,CAAK,wBAASF,CAAU,EACzC,EAMR,OAAO,IAAI,SAAS,GAAGC,EAAS,SAAW,EAAE,IAAID,CAAU,EAAE,EAAE,CACjE,CAOO,IAAMG,EAAN,KAAW,CAEA,SAMT,SAA0B,CAAC,EAOlC,YAAYC,EAAgCC,EAA8B,CAGxE,GADA,KAAK,SAAWD,EACZ,MAAM,QAAQC,CAAI,EAEpB,KAAK,SAAS,KAAK,GAAGA,CAAI,UACjB,OAAOA,GAAS,SAEzB,KAAK,SAAS,KAAKA,CAAI,MAEvB,OAAM,IAAI,UAAU,iDAAiD,CAEzE,CAQO,IACLC,KACGxB,EACK,CACR,QAAWuB,KAAQ,MAAM,SAEvB,GAAI,KAAK,SAASA,CAAI,IAAIC,CAAG,EAAG,CAE9B,IAAIC,EAAO,KAAK,SAASF,CAAI,EAAEC,CAAG,EAClC,OAAIxB,GAAQA,EAAK,OAAS,IAExByB,EAAOA,EAAK,QAAQ,WAAY,CAACC,EAAOC,IAClCA,GAAU,GAAKA,EAAS3B,EAAK,OAExB,OAAOA,EAAK2B,CAAM,EAAM,IAAcD,EAAQ1B,EAAK2B,CAAM,EAE3DD,CACR,GAEID,CACT,CAEF,eAAQ,KAAK,iCAAiCD,CAAG,GAAG,EAC7C,OAAOA,CAAG,CACnB,CAIO,EAAI,KAAK,GAClB",
  "names": ["_unsafeWindow", "IS_DEBUG_LOG", "removeElement", "args", "ele", "e", "setMenu", "name", "fn", "def", "showMapping", "trueShowMapping", "support", "showName", "getValue", "showValue", "trueFn", "ev", "t", "blackList", "newEval", "stringCode", "safety", "value", "I18n", "langJson", "lang", "key", "text", "match", "number"]
}
